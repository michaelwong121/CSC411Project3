\documentclass[11pt,twoside]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{courier} % Required for the courier font
\usepackage{extramarks} % Required for headers and footers
\usepackage{fancyhdr} % Required for custom headers
\usepackage{graphicx} % Required to insert images
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{listings} % Required for insertion of code
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
\usepackage{mathtools}
\usepackage{subcaption}

\usepackage[margin=1in]{geometry}
\usepackage[usenames,dvipsnames]{color} % Required for custom colors

\begin{document}

\title{CSC411 - Project \#3}
\author{Yui Chit (Michael) Wong - 999806232\\Yijin (Catherine) Wang - 998350476}
\maketitle

\clearpage

\section*{Part 1}
\paragraph{Question}
Describe the datasets. You will be predicting whether the review is positive or negative from keywords that appear in the review. Is that feasible? Give 3 examples of specific keywords that may be useful, together with statistics on how often they appear in positive and negative reviews.

\paragraph{Answer}
It is feasible. The word "best" appears in 489 positive reviews and 365 negative reviews. The word "horrendous" appears in 3 positive reviews and 9 negative reviews. The word "awful" appears in 19 positive reviews and 103 negative reviews. Therefore, "best" could be useful to identify positive review, while "horrendous" and "awful" could be used to identify negative review.  (There are 1000 positive reviews and 1000 negative reviews in total.)

\clearpage

\section*{Part 2}

\paragraph{Question}
Implement the Naive Bayes algorithm for predicting whether the review is positive or negative. Tune the parameter $m$ using the validation set, and report how you did it and what was the result. Report the performance on the training and the test sets that you obtain. Note that compting products of many small numbers leads to underflow. Use the fact that $a_1a_2\cdots a_n = exp(loga_1 + loga_2 + \cdots loga_n)$. In your report, explain how you used that fact.

\paragraph{Answer}
In order to predict the review, we use the formula:
\[P(class | a_1, \cdots, a_n) = \frac{P(a_1, \cdots, a_n | class) P(class)}{P(a_1, \cdots, a_n)}\]
If $P(positive|a_1, \cdots, a_n) \geq P(negative|a_1, \cdots, a_n)$, we predict the review to be positive. Otherwise, we predict the review to be negative. Because $P(a_1, \cdots, a_n)$ is the same for $P(positive|a_1, \cdots, a_n)$ and $P(negative|a_1, \cdots, a_n)$, we only need to compare $P(a_1, \cdots, a_n | positive) P(positive)$ and\\ $P(a_1, \cdots, a_n | negative) P(negative)$.
\begin{align*}
P(a_1, \cdots, a_n | class) P(class) &= P(a_1|class) P(a_2|class)\cdots P(a_n|class)P(class)\\
&= exp(log(P(a_1|class))+\cdots+log(P(a_n|class))+log(P(class)))
\end{align*}
Based on the formula above, we only need to compare $log(P(a_1|positive))+\cdots+log(P(a_n|positive))+log(P(positive))$ and $log(P(a_1|negative))+\cdots+log(P(a_n|negative))+log(P(negative))$. Therefore, we implemented our part 2 python program based on the comparison.
\clearpage

\section*{Part 3}

\paragraph{Question}
List the 10 words that most strongly predict that the review is positive, and the 10 words that most strongly predict that the review is negative. State how you obtained those in terms of the the conditional probabilities used in the Naive Bayes algorithm.

\paragraph{Answer}
\[P(class | a_i) = \frac{P(a_i | class) P(class)}{P(a_i)}\]

\clearpage

\section*{Part 4}
\paragraph{Question}


\paragraph{Answer}

\clearpage

\section*{Part 5}
\paragraph{Question}


\paragraph{Answer}

\clearpage

\section*{Part 6}
\paragraph{Question}

\paragraph{Answer}


\clearpage

\section*{Part 7}
\paragraph{Question}


\paragraph{Answer}


\clearpage

\section*{Part 8}
\paragraph{Question}


\paragraph{Answer}


\clearpage


\end{document}